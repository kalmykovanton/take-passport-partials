{"version":3,"sources":["AppCamera.js","AppButton.js","AppImage.js","App.js","index.js"],"names":["AppCamera","_ref","onTakePhoto","onCameraStart","react_default","a","createElement","className","id","build_default","idealFacingMode","FACING_MODES","ENVIRONMENT","isImageMirror","AppButton","title","onClick","AppImage","src","width","alt","App","state","croppedPhoto","croppedBarCode","timestamp","videoRef","photoRectW","photoRectH","photoRectX","photoRectY","barCodeRectW","barCodeRectH","barCodeRectX","barCodeRectY","sendToS3","data","name","axios","post","process","photo","then","r","catch","e","console","error","createPartialFrameOverlay","selector","videoW","videoH","rectW","rectH","x","y","canvasOverlay","document","getElementById","height","ctx","getContext","lineWidth","strokeStyle","strokeRect","initCamera","video","querySelector","offsetWidth","offsetHeight","isLandscapeMode","_this","setState","cropImage","img","newWidth","newHeight","startX","startY","tnCanvas","tnCanvasContext","bufferCanvas","bufferContext","drawImage","toDataURL","setTimeout","dataUri","_this$state","Image","onload","Date","now","concat","openInNewTab","window","open","write","addEventListener","this","_this$state2","canShowCamera","src_AppCamera","Fragment","style","marginRight","src_AppImage","src_AppButton","Component","ReactDOM","render","src_App"],"mappings":"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","file":"static/js/main.d9a965d1.chunk.js","sourcesContent":["import React from \"react\";\nimport Camera, { FACING_MODES } from \"react-html5-camera-photo\";\nimport \"react-html5-camera-photo/build/css/index.css\";\n\nconst AppCamera = ({ onTakePhoto, onCameraStart }) => (\n  <div>\n    <canvas\n      className=\"canvas-partial-frame-overlay\"\n      id=\"canvas-photo-frame-overlay\"\n    />\n    <canvas\n      className=\"canvas-partial-frame-overlay\"\n      id=\"canvas-bar-code-frame-overlay\"\n    />\n    <Camera\n      onTakePhoto={onTakePhoto}\n      onCameraStart={onCameraStart}\n      idealFacingMode={FACING_MODES.ENVIRONMENT}\n      isImageMirror={false}\n    />\n  </div>\n);\n\nexport default AppCamera;\n","import React from \"react\";\n\nconst AppButton = ({ title, onClick }) => (\n  <button onClick={onClick}>{title}</button>\n);\n\nexport default AppButton;\n","import React from \"react\";\n\nconst AppImage = ({ src }) => <img src={src} width=\"250px\" alt=\"\" />;\n\nexport default AppImage;\n","import React, { Component } from \"react\";\nimport axios from \"axios\";\n\nimport AppCamera from \"./AppCamera\";\nimport AppButton from \"./AppButton\";\nimport AppImage from \"./AppImage\";\n\nclass App extends Component {\n  state = {\n    croppedPhoto: \"\",\n    croppedBarCode: \"\",\n    timestamp: \"\",\n    videoRef: null,\n    photoRectW: 0,\n    photoRectH: 0,\n    photoRectX: 0,\n    photoRectY: 0,\n    barCodeRectW: 0,\n    barCodeRectH: 0,\n    barCodeRectX: 0,\n    barCodeRectY: 0\n  };\n\n  componentDidMount() {\n    window.addEventListener(\"resize\", this.initCamera);\n  }\n\n  sendToS3 = (data, name) => {\n    axios\n      .post(process.env.REACT_APP_BE_PATH_TO_UPLOAD, {\n        photo: data,\n        name\n      })\n      .then(r => r)\n      .catch(e => console.error(\"UPLOAD ERROR => \", e));\n  };\n\n  createPartialFrameOverlay = ({\n    selector,\n    videoW,\n    videoH,\n    rectW,\n    rectH,\n    x,\n    y\n  }) => {\n    const canvasOverlay = document.getElementById(selector);\n    canvasOverlay.width = videoW;\n    canvasOverlay.height = videoH;\n    const ctx = canvasOverlay.getContext(\"2d\");\n    ctx.lineWidth = 1;\n    ctx.strokeStyle = \"#fff\";\n    ctx.strokeRect(x, y, rectW, rectH);\n  };\n\n  initCamera = () => {\n    const video = document.querySelector(\"video\");\n\n    if (!video) return;\n\n    const videoW = video.offsetWidth;\n    const videoH = video.offsetHeight;\n    const isLandscapeMode = video.offsetWidth > video.offsetHeight;\n\n    const photoRectH = isLandscapeMode ? videoH * 0.34 : videoH * 0.2;\n    const photoRectW = isLandscapeMode ? videoW * 0.2 : videoW * 0.34;\n    const photoRectX = isLandscapeMode ? videoW * 0.07 : videoW * 0.35;\n    const photoRectY = isLandscapeMode ? videoH * 0.3 : videoH * 0.065;\n\n    const barCodeRectH = isLandscapeMode ? videoH * 0.16 : videoH * 0.94;\n    const barCodeRectW = isLandscapeMode ? videoW * 0.94 : videoW * 0.16;\n    const barCodeRectX = isLandscapeMode\n      ? (videoW - barCodeRectW) / 2\n      : videoW * 0.055;\n    const barCodeRectY = isLandscapeMode\n      ? videoH * 0.78\n      : (videoH - barCodeRectH) / 2;\n\n    this.createPartialFrameOverlay({\n      selector: \"canvas-photo-frame-overlay\",\n      videoW,\n      videoH,\n      rectW: photoRectW,\n      rectH: photoRectH,\n      x: photoRectX,\n      y: photoRectY\n    });\n\n    this.createPartialFrameOverlay({\n      selector: \"canvas-bar-code-frame-overlay\",\n      videoW,\n      videoH,\n      rectW: barCodeRectW,\n      rectH: barCodeRectH,\n      x: barCodeRectX,\n      y: barCodeRectY\n    });\n\n    this.setState({\n      videoRef: video,\n      photoRectW,\n      photoRectH,\n      photoRectX,\n      photoRectY,\n      barCodeRectW,\n      barCodeRectH,\n      barCodeRectX,\n      barCodeRectY\n    });\n  };\n\n  cropImage = (img, newWidth, newHeight, startX, startY) => {\n    const tnCanvas = document.createElement(\"canvas\");\n    const tnCanvasContext = tnCanvas.getContext(\"2d\");\n    tnCanvas.width = newWidth;\n    tnCanvas.height = newHeight;\n\n    const bufferCanvas = document.createElement(\"canvas\");\n    const bufferContext = bufferCanvas.getContext(\"2d\");\n    bufferCanvas.width = img.width;\n    bufferCanvas.height = img.height;\n    bufferContext.drawImage(img, 0, 0, img.width, img.height);\n\n    tnCanvasContext.drawImage(\n      bufferCanvas,\n      startX,\n      startY,\n      newWidth,\n      newHeight,\n      0,\n      0,\n      newWidth,\n      newHeight\n    );\n\n    return tnCanvas.toDataURL();\n  };\n\n  onCameraStart = setTimeout(this.initCamera, 2000);\n\n  onTakePhoto = dataUri => {\n    const {\n      videoRef,\n      photoRectW,\n      photoRectH,\n      photoRectX,\n      photoRectY,\n      barCodeRectW,\n      barCodeRectH,\n      barCodeRectX,\n      barCodeRectY\n    } = this.state;\n\n    const img = new Image();\n    img.src = dataUri;\n    img.width = videoRef.offsetWidth;\n    img.height = videoRef.offsetHeight;\n    img.onload = () => {\n      const croppedPhoto = this.cropImage(\n        img,\n        photoRectW,\n        photoRectH,\n        photoRectX,\n        photoRectY\n      );\n      const croppedBarCode = this.cropImage(\n        img,\n        barCodeRectW,\n        barCodeRectH,\n        barCodeRectX,\n        barCodeRectY\n      );\n\n      const timestamp = Date.now();\n\n      this.setState({ croppedPhoto, croppedBarCode, timestamp });\n      this.sendToS3(dataUri, `passport_photo_${timestamp}`);\n      this.sendToS3(dataUri, `passport_bar_code_${timestamp}`);\n    };\n  };\n\n  openInNewTab = data => () => {\n    const newWindow = window.open();\n    newWindow.document.write(`<img src=\"${data}\">`);\n  };\n\n  render() {\n    const { croppedPhoto, croppedBarCode, timestamp } = this.state;\n    const canShowCamera = !croppedPhoto && !croppedBarCode;\n\n    return (\n      <div className=\"app\">\n        {canShowCamera && (\n          <AppCamera\n            onTakePhoto={this.onTakePhoto}\n            onCameraStart={this.onCameraStart}\n          />\n        )}\n        {croppedPhoto && (\n          <React.Fragment>\n            <div className=\"images-wrapper\">\n              <div\n                className=\"images-wrapper__item\"\n                style={{ marginRight: \"15px\" }}\n              >\n                <AppImage src={croppedPhoto} />\n                <AppButton\n                  title={`passport_photo_${timestamp}`}\n                  onClick={this.openInNewTab(croppedPhoto)}\n                />\n                <AppImage src={croppedBarCode} />\n                <AppButton\n                  title={`passport_bar_code_${timestamp}`}\n                  onClick={this.openInNewTab(croppedBarCode)}\n                />\n              </div>\n            </div>\n          </React.Fragment>\n        )}\n      </div>\n    );\n  }\n}\n\nexport default App;\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\n\nimport \"./index.css\";\nimport App from \"./App\";\n\nReactDOM.render(<App />, document.getElementById(\"root\"));\n"],"sourceRoot":""}