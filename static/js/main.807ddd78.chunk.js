(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{17:function(e,t,a){e.exports=a(43)},23:function(e,t,a){},43:function(e,t,a){"use strict";a.r(t);var o=a(0),r=a.n(o),n=a(15),i=a.n(n),c=(a(23),a(2)),h=a(3),d=a(5),s=a(4),m=a(6),l=a(16),p=a.n(l),v=a(8),u=a.n(v),g=function(e){function t(e,a){var o;return Object(c.a)(this,t),(o=Object(d.a)(this,Object(s.a)(t).call(this,e,a))).takePhoto=function(){(0,o.props.onTakePhoto)(o.cameraPhoto.getDataUri({sizeFactor:1}))},o.cameraPhoto=null,o.videoRef=r.a.createRef(),o}return Object(m.a)(t,e),Object(h.a)(t,[{key:"componentDidMount",value:function(){this.cameraPhoto=new u.a(this.videoRef.current),this.startCamera()}},{key:"startCamera",value:function(){var e=v.FACING_MODES.ENVIRONMENT;this.cameraPhoto.startCamera(e,{width:1920,height:1080})}},{key:"render",value:function(){var e=this.props,t=e.videoWidth,a=e.videoHeight;return r.a.createElement(o.Fragment,null,r.a.createElement("video",{ref:this.videoRef,width:t,height:a,playsInline:!0,autoPlay:!0}),r.a.createElement("span",{className:"take-photo",onClick:this.takePhoto}))}}]),t}(r.a.Component),f=function(e){var t=e.onTakePhoto,a=e.onCameraStart,o=e.videoHeight,n=e.videoWidth;return r.a.createElement("div",null,r.a.createElement("canvas",{className:"canvas-partial-frame-overlay",id:"canvas-photo-frame-overlay"}),r.a.createElement("canvas",{className:"canvas-partial-frame-overlay",id:"canvas-bar-code-frame-overlay"}),r.a.createElement(g,{videoHeight:o,videoWidth:n,onTakePhoto:t,onCameraStart:a,isImageMirror:!1}))},w=function(e){var t=e.title,a=e.onClick;return r.a.createElement("button",{onClick:a},t)},R=function(e){var t=e.src;return r.a.createElement("img",{src:t,width:"250px",alt:""})},C=function(e){function t(){var e,a;Object(c.a)(this,t);for(var o=arguments.length,r=new Array(o),n=0;n<o;n++)r[n]=arguments[n];return(a=Object(d.a)(this,(e=Object(s.a)(t)).call.apply(e,[this].concat(r)))).state={passportAspectRatio:1.414634146,croppedPhoto:"",croppedBarCode:"",timestamp:"",photoRectW:0,photoRectH:0,photoRectX:0,photoRectY:0,barCodeRectW:0,barCodeRectH:0,barCodeRectX:0,barCodeRectY:0},a.sendToS3=function(e,t){p.a.post("https://s3-bucket-proxy.mobidevdemo.com/upload",{photo:e,name:t}).then(function(e){return e}).catch(function(e){return console.error("UPLOAD ERROR => ",e)})},a.createPartialFrameOverlay=function(e){var t=e.selector,a=e.videoW,o=e.videoH,r=e.rectW,n=e.rectH,i=e.x,c=e.y,h=document.getElementById(t);h.width=a,h.height=o;var d=h.getContext("2d");d.lineWidth=1,d.strokeStyle="#fff",d.strokeRect(i,c,r,n)},a.getViewPortInfo=function(){var e=Math.max(document.documentElement.clientWidth,window.innerWidth||0),t=Math.max(document.documentElement.clientHeight,window.innerHeight||0);return{viewPortWidth:e,viewPortHeight:t,viewPortAspectRatio:e/t||0,isLandscapeMode:e>t}},a.getOptimalVideoDimensions=function(){var e=a.getViewPortInfo(),t=e.viewPortHeight,o=e.viewPortWidth,r=e.viewPortAspectRatio,n=a.state.passportAspectRatio;return r>n?{height:t,width:Math.floor(t*n)}:{width:o,height:Math.floor(o/n)}},a.initCamera=function(){if(a.videoRef&&!a.state.croppedPhoto&&!a.state.croppedBarCode){var e,t,o,r,n,i,c,h,d=a.getOptimalVideoDimensions(),s=d.height,m=d.width;n=.16*s,h=.78*s,e=.49*s,t=.27*m,o=c=(m-(i=.94*m))/2,r=.25*s,a.createPartialFrameOverlay({selector:"canvas-photo-frame-overlay",videoW:m,videoH:s,rectW:t,rectH:e,x:o,y:r}),a.createPartialFrameOverlay({selector:"canvas-bar-code-frame-overlay",videoW:m,videoH:s,rectW:i,rectH:n,x:c,y:h}),a.setState({photoRectW:t,photoRectH:e,photoRectX:o,photoRectY:r,barCodeRectW:i,barCodeRectH:n,barCodeRectX:c,barCodeRectY:h,videoW:m,videoH:s})}},a.cropImage=function(e,t,a,o,r,n,i){var c=document.createElement("canvas"),h=c.getContext("2d");c.width=t,c.height=a;var d=document.createElement("canvas"),s=d.getContext("2d");return d.width=i,d.height=n,s.drawImage(e,0,0,i,n),h.drawImage(d,o,r,t,a,0,0,t,a),c.toDataURL()},a.onCameraStart=setTimeout(a.initCamera,2e3),a.getRenderedSize=function(e,t,a,o,r){var n=a/o,i=e/t;return function(){return n<i?(this.width=e,this.height=e/n):(this.width=t*n,this.height=t),this.left=(e-this.width)*(r/100),this.right=this.width+this.left,this}.call({})},a.getImgSizeInfo=function(e){return a.getRenderedSize(e.width,e.height,e.naturalWidth,e.naturalHeight,50)},a.onTakePhoto=function(e){var t=a.state,o=t.photoRectW,r=t.photoRectH,n=t.photoRectX,i=t.photoRectY,c=t.barCodeRectW,h=t.barCodeRectH,d=t.barCodeRectX,s=t.barCodeRectY,m=t.videoH,l=t.videoW,p=new Image;p.style.objectFit="cover",p.src=e,p.width=l,p.height=m,p.onload=function(e){var t=a.getImgSizeInfo(e.target),m=t.height,l=t.width,p=t.left,v=a.cropImage(e.target,o,r,n+Math.abs(p),i,m,l),u=a.cropImage(e.target,c,h,d+Math.abs(p),s,m,l),g=Date.now();a.setState({croppedPhoto:v,croppedBarCode:u,timestamp:g}),a.sendToS3(v,"passport_photo_".concat(g)),a.sendToS3(u,"passport_bar_code_".concat(g))}},a.openInNewTab=function(e){return function(){window.open().document.write('<img src="'.concat(e,'">'))}},a}return Object(m.a)(t,e),Object(h.a)(t,[{key:"componentDidMount",value:function(){this.videoRef=document.querySelector("video"),window.addEventListener("resize",this.initCamera)}},{key:"render",value:function(){var e=this.state,t=e.croppedPhoto,a=e.croppedBarCode,o=e.timestamp,n=e.videoW,i=e.videoH,c=e.dataUri,h=!t&&!a;return c?r.a.createElement("div",{className:"app"},r.a.createElement("img",{src:c,width:n,alt:""})):r.a.createElement("div",{className:"app"},h&&r.a.createElement(f,{onTakePhoto:this.onTakePhoto,onCameraStart:this.onCameraStart,videoHeight:i,videoWidth:n}),t&&r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"images-wrapper"},r.a.createElement("div",{className:"images-wrapper__item",style:{marginRight:"15px"}},r.a.createElement(R,{src:t}),r.a.createElement(w,{title:"passport_photo_".concat(o),onClick:this.openInNewTab(t)}),r.a.createElement(R,{src:a}),r.a.createElement(w,{title:"passport_bar_code_".concat(o),onClick:this.openInNewTab(a)})))))}}]),t}(o.Component);i.a.render(r.a.createElement(C,null),document.getElementById("root"))}},[[17,1,2]]]);
//# sourceMappingURL=main.807ddd78.chunk.js.map